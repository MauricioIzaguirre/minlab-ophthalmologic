---
// AppHeader.astro - Header principal de la aplicación siguiendo el patrón de Basecoat
---

<header class="bg-background sticky inset-x-0 top-0 isolate flex shrink-0 items-center gap-2 border-b z-10">
  <div class="flex h-14 w-full items-center gap-2 px-4">
    <!-- Toggle Sidebar Button -->
    <button 
      type="button" 
      onclick="document.dispatchEvent(new CustomEvent('basecoat:sidebar'))" 
      aria-label="Toggle sidebar" 
      data-tooltip="Toggle sidebar" 
      data-side="bottom" 
      data-align="start" 
      class="btn-sm-icon-ghost mr-auto size-7 -ml-1.5"
    >
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <rect width="18" height="18" x="3" y="3" rx="2"></rect>
        <path d="M9 3v18"></path>
      </svg>
    </button>
    
    <!-- Theme Select -->
    <select class="select h-8 leading-none" id="theme-select">
      <option value="">Default</option>
      <option value="claude">Claude</option>
      <option value="supabase">Supabase</option>
    </select>
    
    <!-- Theme Toggle Button -->
    <button 
      type="button" 
      aria-label="Toggle dark mode" 
      data-tooltip="Toggle dark mode" 
      data-side="bottom" 
      onclick="document.dispatchEvent(new CustomEvent('basecoat:theme'))" 
      class="btn-icon-outline size-8"
    >
      <span class="hidden dark:block">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="4"></circle>
          <path d="M12 2v2"></path>
          <path d="M12 20v2"></path>
          <path d="m4.93 4.93 1.41 1.41"></path>
          <path d="m17.66 17.66 1.41 1.41"></path>
          <path d="M2 12h2"></path>
          <path d="M20 12h2"></path>
          <path d="m6.34 17.66-1.41 1.41"></path>
          <path d="m19.07 4.93-1.41 1.41"></path>
        </svg>
      </span>
      <span class="block dark:hidden">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path>
        </svg>
      </span>
    </button>
    <img 
      class="size-8 shrink-0 object-cover rounded-full" 
      alt="@hunvreus" 
      src="https://github.com/hunvreus.png"
      data-tooltip="User profile" 
      data-side="bottom" 
      data-align="end"
    >
    <!-- GitHub Link 
    <a href="https://github.com" class="btn-icon size-8" target="_blank" rel="noopener noreferrer" data-tooltip="GitHub repository" data-side="bottom" data-align="end">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"></path>
        <path d="M9 18c-4.51 2-5-2-7-2"></path>
      </svg>
    </a> 
    -->
    
  </div>
</header>

<script>
  (() => {
    const themeSelect = document.getElementById('theme-select') as HTMLSelectElement;
    const storedTheme = localStorage.getItem('themeVariant');
    if (themeSelect && storedTheme) themeSelect.value = storedTheme;
    themeSelect?.addEventListener('change', () => {
      const newTheme = themeSelect.value;
      document.documentElement.classList.forEach(c => {
        if (c.startsWith('theme-')) document.documentElement.classList.remove(c);
      });
      if (newTheme) {
        document.documentElement.classList.add(`theme-${newTheme}`);
        localStorage.setItem('themeVariant', newTheme);
      } else {
        localStorage.removeItem('themeVariant');
      }
    });
  })();
</script>