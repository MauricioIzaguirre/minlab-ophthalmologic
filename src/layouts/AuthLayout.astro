---
import "../styles/global.css";
import ThemeSwitcher from "../components/ui/themeSwitcher.astro";

export interface Props {
  title?: string;
  description?: string;
}

const { 
  title = "Authentication", 
  description = "Access your account securely" 
} = Astro.props;
---

<!doctype html>
<html lang="en" class="theme-claude">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={description} />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    <title>{title}</title>
    <!-- Preload critical resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <script>
      (() => {
        try {
          const stored = localStorage.getItem('themeMode');
          if (stored ? stored === 'dark'
                      : matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
          }
        } catch (_) {}

        const apply = (dark: boolean) => {
          document.documentElement.classList.toggle('dark', dark);
          try { localStorage.setItem('themeMode', dark ? 'dark' : 'light'); } catch (_) {}
        };

        document.addEventListener('basecoat:theme', (event) => {
          const mode = (event as CustomEvent).detail?.mode;
          apply(mode === 'dark' ? true
                : mode === 'light' ? false
                : !document.documentElement.classList.contains('dark'));
        });
      })();
    </script>
  </head>
  
  <body class="min-h-screen bg-background font-sans antialiased bg-dotted-pattern hide-scrollbar">
    <!-- Main Authentication Container -->
    <div class="relative flex min-h-screen">
      <!-- Left Side - Branding/Info (hidden on mobile) -->
      <div class="hidden lg:flex lg:w-1/2 lg:flex-col lg:justify-center lg:px-12 xl:px-24 bg-card/50 backdrop-blur-sm">
        <div class="mx-auto max-w-md">
          <div class="mb-8">
            <div class="flex h-12 w-12 items-center justify-center rounded-lg bg-primary">
              <svg class="h-8 w-8 text-primary-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
              </svg>
            </div>
          </div>
          
          <h1 class="text-3xl font-bold tracking-tight text-foreground">
            Welcome back
          </h1>
          <p class="mt-4 text-lg text-muted-foreground">
            Sign in to your account and continue where you left off. Your productivity is waiting for you.
          </p>
          
          <!-- Feature List -->
          <div class="mt-8 space-y-4">
            <div class="flex items-center gap-3">
              <div class="flex h-6 w-6 items-center justify-center rounded-full bg-primary/10">
                <svg class="h-4 w-4 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
              </div>
              <span class="text-sm text-muted-foreground">Secure and protected access</span>
            </div>
            <div class="flex items-center gap-3">
              <div class="flex h-6 w-6 items-center justify-center rounded-full bg-primary/10">
                <svg class="h-4 w-4 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
              </div>
              <span class="text-sm text-muted-foreground">Sync across all your devices</span>
            </div>
            <div class="flex items-center gap-3">
              <div class="flex h-6 w-6 items-center justify-center rounded-full bg-primary/10">
                <svg class="h-4 w-4 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
              </div>
              <span class="text-sm text-muted-foreground">24/7 support available</span>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Right Side - Authentication Form -->
      <div class="flex w-full lg:w-1/2 flex-col justify-center px-6 py-12 sm:px-12 lg:px-24 min-h-screen hide-scrollbar overflow-y-auto">
        <div class="mx-auto w-full max-w-md">
          <!-- Mobile Logo -->
          <div class="lg:hidden mb-8 text-center">
            <div class="flex h-12 w-12 items-center justify-center rounded-lg bg-primary mx-auto mb-4">
              <svg class="h-8 w-8 text-primary-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
              </svg>
            </div>
          </div>
          
          <!-- Authentication Form Slot -->
          <slot />
          
          <!-- Footer Links -->
          <div class="mt-8 text-center">
            <p class="text-xs text-muted-foreground">
              By continuing, you agree to our 
              <a href="/legal/terms" class="underline underline-offset-4 hover:text-primary">Terms of Service</a>
              and 
              <a href="/legal/privacy" class="underline underline-offset-4 hover:text-primary">Privacy Policy</a>.
            </p>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Theme Toggle Button Component -->
    <ThemeSwitcher />
  </body>
</html>

<style>
  /* Dotted background pattern that adapts to content height */
  .bg-dotted-pattern {
    background-image: radial-gradient(circle at 1px 1px, rgba(255,255,255,0.25) 1px, transparent 0);
    background-size: 16px 16px;
    background-attachment: local; /* Key: makes background scroll with content */
  }
  
  /* Dark theme variation */
  html.dark .bg-dotted-pattern {
    background-image: radial-gradient(circle at 1px 1px, rgba(255,255,255,0.12) 1px, transparent 0);
  }
  
  /* Hide scrollbar completely but keep functionality */
  html::-webkit-scrollbar,
  body::-webkit-scrollbar {
    width: 0px;
    height: 0px;
    background: transparent;
  }
  
  html::-webkit-scrollbar-thumb,
  body::-webkit-scrollbar-thumb {
    background: transparent;
  }
  
  html::-webkit-scrollbar-track,
  body::-webkit-scrollbar-track {
    background: transparent;
  }
  
  html,
  body {
    -ms-overflow-style: none; /* IE and Edge */
    scrollbar-width: none; /* Firefox */
    overflow-x: hidden; /* Prevent horizontal scroll */
  }
  
  /* Apply to any scrollable elements */
  .hide-scrollbar::-webkit-scrollbar {
    width: 0px;
    height: 0px;
    background: transparent;
  }
  
  .hide-scrollbar::-webkit-scrollbar-thumb {
    background: transparent;
  }
  
  .hide-scrollbar::-webkit-scrollbar-track {
    background: transparent;
  }
  
  .hide-scrollbar {
    -ms-overflow-style: none; /* IE and Edge */
    scrollbar-width: none; /* Firefox */
  }
  
  /* Smooth transitions */
  html {
    transition: background-color 0.2s ease, color 0.2s ease;
  }
  
  /* Focus styles for accessibility */
  button:focus-visible,
  input:focus-visible,
  a:focus-visible {
    outline: 2px solid hsl(var(--ring));
    outline-offset: 2px;
  }
</style>